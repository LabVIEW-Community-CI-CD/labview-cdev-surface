name: release-workspace-installer

on:
  workflow_dispatch:
    inputs:
      release_tag:
        description: "Release tag to publish (SemVer preferred: vX.Y.Z / vX.Y.Z-rc.N / vX.Y.Z-canary.N; legacy migration: v0.YYYYMMDD.N)."
        required: true
        type: string
      allow_existing_tag:
        description: Allow updating an existing release tag (break-glass only).
        required: false
        default: false
        type: boolean
      prerelease:
        description: Publish as prerelease.
        required: false
        default: false
        type: boolean
      release_channel:
        description: Explicit release channel metadata (stable, prerelease, canary). Leave blank to derive from prerelease.
        required: false
        default: ''
        type: string

permissions:
  contents: write

jobs:
  release-workspace-installer:
    name: Release Workspace Installer
    uses: ./.github/workflows/_release-workspace-installer-core.yml
    with:
      release_tag: ${{ inputs.release_tag }}
      allow_existing_tag: ${{ inputs.allow_existing_tag }}
      prerelease: ${{ inputs.prerelease }}
      release_channel: ${{ inputs.release_channel }}
    secrets: inherit
